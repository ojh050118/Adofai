clone_depth: 1
version: '{branch}-{build}'
image: Visual Studio 2019
dotnet_csproj:
  patch: true
  file: 'adofai.Game\adofai.Game.csproj' # Use wildcard when it's able to exclude Xamarin projects
  version: '0.0.{build}'
cache:
  - '%LOCALAPPDATA%\NuGet\v3-cache -> appveyor.yml'
before_build:
  - ps: dotnet --info # Useful when version mismatch between CI and local
  - ps: nuget restore -verbosity quiet # Only nuget.exe knows both new (.NET Core) and old (Xamarin) projects
build:
  project: adofai.sln
  parallel: true
  verbosity: minimal
  publish_nuget: true
after_build:
  - ps: dotnet tool restore
  - ps: dotnet format --dry-run --check
  - ps: .\InspectCode.ps1
test:
  assemblies:
    except:
      - 'build\**\*'
on_success:
  - ps: Invoke-RestMethod https://raw.githubusercontent.com/DiscordHooks/appveyor-discord-webhook/master/send.ps1 -o send.ps1
  - ps: ./send.ps1 success $env:https://discord.com/api/webhooks/803643798650486795/hB0aOsU286JQ3U7G3AgBKpvnCiPib6vHtuujSA9ciW-nEBsqJ1tlfl2GIEgbW-cjJgpd
on_failure:
  - ps: Invoke-RestMethod https://raw.githubusercontent.com/DiscordHooks/appveyor-discord-webhook/master/send.ps1 -o send.ps1
  - ps: ./send.ps1 failure $env:https://discord.com/api/webhooks/803643798650486795/hB0aOsU286JQ3U7G3AgBKpvnCiPib6vHtuujSA9ciW-nEBsqJ1tlfl2GIEgbW-cjJgpd